# 即梦4.0图片生成器 - 环境设置指南

## 当前状态
✅ 已创建 `.env` 配置文件（从 `.env.example` 复制）

## 需要完成的步骤

### 1. 安装 Python（必需）

您的系统中需要先安装 Python 3.7 或更高版本。

#### Windows 系统安装 Python：

**方法一：从官网下载（推荐）**
1. 访问 Python 官网：https://www.python.org/downloads/
2. 下载 Python 3.11 或 3.12（推荐最新稳定版）
3. 运行安装程序，**务必勾选 "Add Python to PATH"**
4. 点击 "Install Now" 完成安装

**方法二：使用 Microsoft Store**
1. 打开 Microsoft Store
2. 搜索 "Python 3.11" 或 "Python 3.12"
3. 点击安装

**验证安装：**
安装完成后，重新打开 PowerShell，运行以下命令验证：
```powershell
python --version
# 或
python3 --version
```

应该显示类似：`Python 3.11.x` 或 `Python 3.12.x`

### 2. 安装项目依赖包

Python 安装完成后，在项目目录运行：

```powershell
# 进入项目目录
cd d:\project\jimeng4_image_generator

# 安装依赖包
python -m pip install -r requirements.txt

# 或者使用 python3
python3 -m pip install -r requirements.txt
```

依赖包列表：
- `requests` - HTTP请求库
- `python-dotenv` - 环境变量管理
- `Pillow` - 图片处理
- `Flask` - Web框架
- `volcengine` - 火山引擎SDK
- `oss2` - 阿里云OSS SDK

### 3. 配置API密钥

编辑刚创建的 `.env` 文件，填入您的密钥：

#### 必需配置（火山引擎）：
```env
VOLCENGINE_AK=your_access_key_here
VOLCENGINE_SK=your_secret_key_here
```

获取方式：
1. 访问：https://console.volcengine.com/iam/keymanage/
2. 登录火山引擎账号
3. 创建或查看您的 Access Key 和 Secret Key
4. 将密钥复制到 `.env` 文件中

#### 可选配置（阿里云OSS - 仅图生图功能需要）：
```env
OSS_ENABLED=true
OSS_ENDPOINT=your-bucket.oss-region.aliyuncs.com
OSS_ACCESS_KEY_ID=your_aliyun_access_key_id
OSS_ACCESS_KEY_SECRET=your_aliyun_access_key_secret
```

如果只使用文字生成图片，OSS配置保持默认即可。

### 4. 初始化数据库（自动）

首次运行程序时，数据库会自动创建。无需手动操作。

### 5. 启动应用

完成上述步骤后，可以启动Web应用：

```powershell
# 启动Web界面
python web_app.py
```

然后在浏览器中访问：http://localhost:5000

或者使用命令行工具（需要有 main.py 文件）：
```powershell
# 生成单张图片
python main.py --prompt "您的提示词"
```

## 常见问题

### Q: pip 命令找不到
**A:** 使用 `python -m pip` 替代 `pip`，例如：
```powershell
python -m pip install -r requirements.txt
```

### Q: 提示"无法将 python 项识别为 cmdlet"
**A:** Python 未正确安装或未添加到系统 PATH。请：
1. 重新安装 Python，确保勾选 "Add Python to PATH"
2. 或手动将 Python 安装目录添加到系统环境变量

### Q: 依赖包安装失败
**A:** 尝试升级 pip：
```powershell
python -m pip install --upgrade pip
```

### Q: 如何测试配置是否正确
**A:** 可以运行测试脚本：
```powershell
# 测试 OSS 配置
python test_oss.bat

# 测试 API 调用
python test_sample_api.py
```

## 下一步

环境设置完成后，您可以：
1. 查看 [README.md](README.md) 了解详细使用说明
2. 查看 [WEB_README.md](WEB_README.md) 了解Web界面功能
3. 参考 [example_prompts.txt](example_prompts.txt) 获取提示词灵感

---

如有问题，请参考项目文档或提交 Issue。
