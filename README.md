# å³æ¢¦4.0 API å›¾ç‰‡ç”Ÿæˆå·¥å…·

ä¸€ä¸ªç®€å•æ˜“ç”¨çš„Pythonå·¥å…·ï¼Œç”¨äºè°ƒç”¨å³æ¢¦4.0 APIç”Ÿæˆé«˜è´¨é‡å›¾ç‰‡ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- ğŸš€ æ”¯æŒæ–‡æœ¬ç”Ÿæˆå›¾ç‰‡
- ğŸ“ æ‰¹é‡ç”ŸæˆåŠŸèƒ½ï¼Œæ”¯æŒå¤šç»„æç¤ºè¯
- ğŸ¨ å¤šç§å°ºå¯¸é€‰æ‹©ï¼Œæœ€é«˜æ”¯æŒ4Kåˆ†è¾¨ç‡
- ğŸ’¾ è‡ªåŠ¨ä¿å­˜ç”Ÿæˆçš„å›¾ç‰‡
- ğŸ”§ ä¸°å¯Œçš„å‚æ•°é…ç½®ï¼ˆç§å­ã€æ°´å°ã€æ–‡æœ¬å½±å“ç¨‹åº¦ç­‰ï¼‰
- ğŸ” æ”¯æŒç«å±±å¼•æ“APIçš„HMAC-SHA256ç­¾åè®¤è¯
- ğŸŒ æä¾›Flaskç½‘é¡µç•Œé¢ï¼Œæ–¹ä¾¿ç›´è§‚æ“ä½œ
- ğŸ‘¥ **å¤šç”¨æˆ·æ”¯æŒ**ï¼Œæ¯ä¸ªç”¨æˆ·æ‹¥æœ‰ç‹¬ç«‹çš„æ•°æ®å’Œæ–‡ä»¶ç©ºé—´

## å®‰è£…æŒ‡å—

### å‰ç½®è¦æ±‚

- Python 3.7+
- ç«å±±å¼•æ“è´¦å·åŠAccess Key/Secret Keyï¼ˆå¯ä»[ç«å±±å¼•æ“](https://www.volcengine.com/)è·å–ï¼‰

### å®‰è£…æ­¥éª¤

1. å…‹éš†æˆ–ä¸‹è½½æœ¬é¡¹ç›®
```bash
git clone https://github.com/qiuhe2023/jimeng4_image_generator.git
cd jimeng4_image_generator
```

2. å®‰è£…ä¾èµ–åŒ…
```bash
pip install -r requirements.txt
```

3. é…ç½®APIå¯†é’¥
   - å¤åˆ¶`.env.example`æ–‡ä»¶ä¸º`.env`
   - ç¼–è¾‘`.env`æ–‡ä»¶ï¼Œå¡«å…¥æ‚¨çš„ç«å±±å¼•æ“Access Keyå’ŒSecret Key
```bash
cp .env.example .env
nano .env
```

## ä½¿ç”¨è¯´æ˜

### å‘½ä»¤è¡Œä½¿ç”¨

```bash
# ä½¿ç”¨å•ä¸ªæç¤ºè¯ç”Ÿæˆå›¾ç‰‡
python main.py --prompt "A beautiful landscape with mountains and lake at sunset"

# æŒ‡å®šå°ºå¯¸ç”Ÿæˆå›¾ç‰‡
python main.py --prompt "A futuristic city skyline" --size 2560x1440

# ç”Ÿæˆå¤šå¼ å›¾ç‰‡
python main.py --prompt "A cute cat" --count 3

# ä¸æ·»åŠ æ°´å°
python main.py --prompt "A portrait of a knight" --no-watermark
```

### æ‰¹é‡ç”Ÿæˆ

```bash
# ä»æ–‡ä»¶åŠ è½½æç¤ºè¯æ‰¹é‡ç”Ÿæˆ
python main.py --file example_prompts.txt

# æŒ‡å®šè¾“å‡ºç›®å½•
python main.py --file example_prompts.txt --output my_artworks
```

### é«˜çº§ç”¨æ³•

```bash
# æŒ‡å®šéšæœºç§å­ï¼ˆå¯å¤ç°ç»“æœï¼‰
python main.py --prompt "A sushi platter" --seed 12345

# è°ƒæ•´æ–‡æœ¬å½±å“ç¨‹åº¦
python main.py --prompt "A dragon flying over a castle" --scale 0.8

# é€šè¿‡å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šå¯†é’¥
python main.py --prompt "A cozy cabin" --access-key YOUR_ACCESS_KEY --secret-key YOUR_SECRET_KEY
```

### å‘½ä»¤è¡Œå‚æ•°è¯´æ˜

| å‚æ•° | ç¼©å†™ | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|------|--------|
| `--prompt` | `-p` | å›¾ç‰‡ç”Ÿæˆæç¤ºè¯ | æ—  |
| `--file` | `-f` | åŒ…å«æç¤ºè¯çš„æ–‡æœ¬æ–‡ä»¶è·¯å¾„ | æ—  |
| `--size` | `-s` | å›¾ç‰‡å°ºå¯¸ï¼Œå¦‚'2048x2048' | `2048x2048` |
| `--count` | `-c` | ç”Ÿæˆå›¾ç‰‡æ•°é‡ | `1` |
| `--output` | `-o` | è¾“å‡ºç›®å½• | `output` |
| `--access-key` | `-ak` | ç«å±±å¼•æ“Access Key | ä»ç¯å¢ƒå˜é‡è·å– |
| `--secret-key` | `-sk` | ç«å±±å¼•æ“Secret Key | ä»ç¯å¢ƒå˜é‡è·å– |
| `--no-watermark` | æ—  | ä¸æ·»åŠ æ°´å° | `False` |
| `--seed` | æ—  | éšæœºç§å­ï¼Œ-1è¡¨ç¤ºéšæœº | `-1` |
| `--scale` | æ—  | æ–‡æœ¬å½±å“ç¨‹åº¦ï¼Œ0-1ä¹‹é—´ | `0.5` |

## ç½‘é¡µç•Œé¢ä½¿ç”¨

æœ¬é¡¹ç›®æä¾›äº†ä¸€ä¸ªåŸºäºFlaskçš„ç½‘é¡µç•Œé¢ï¼Œæ–¹ä¾¿ç”¨æˆ·é€šè¿‡æµè§ˆå™¨æ“ä½œï¼š

1. å¯åŠ¨WebæœåŠ¡
```bash
python web_app.py
```

2. åˆ›å»ºç”¨æˆ·è´¦å·
   
   **æ–¹å¼ä¸€ï¼šä½¿ç”¨ç®¡ç†è„šæœ¬ï¼ˆæ¨èï¼‰**
   ```bash
   # åˆ›å»ºæ–°ç”¨æˆ·
   python manage_users.py add username password
   
   # åˆ—å‡ºæ‰€æœ‰ç”¨æˆ·
   python manage_users.py list
   
   # ä¿®æ”¹ç”¨æˆ·å¯†ç 
   python manage_users.py password username new_password
   
   # åˆ é™¤ç”¨æˆ·
   python manage_users.py delete username
   ```
   
   **æ–¹å¼äºŒï¼šä½¿ç”¨é»˜è®¤æµ‹è¯•è´¦å·**
   - ç”¨æˆ·åï¼š`admin`
   - å¯†ç ï¼š`admin123`

3. ç™»å½•ç³»ç»Ÿ
   - ä½¿ç”¨æ³¨å†Œçš„è´¦å·ç™»å½•
   - ç™»å½•åå¯è®¿é—®æ‰€æœ‰åŠŸèƒ½

4. åŠŸèƒ½é¡µé¢ï¼š
   - ğŸ¨ **å•å›¾ç”Ÿæˆ**ï¼šè¾“å…¥æç¤ºè¯ç”Ÿæˆå•å¼ å›¾ç‰‡
   - ğŸ“¦ **æ‰¹é‡ç”Ÿæˆ**ï¼šä»Excelå¯¼å…¥å¤šä¸ªä»»åŠ¡æ‰¹é‡ç”Ÿæˆ
   - ğŸ“Š **ç”Ÿæˆè®°å½•**ï¼šæŸ¥çœ‹å†å²è®°å½•ï¼Œæ”¯æŒæ‰¹é‡ä¸‹è½½å’Œåˆ é™¤
   - ğŸ–¼ï¸ **ç¤ºä¾‹å›¾ç®¡ç†**ï¼šä¸Šä¼ å’Œç®¡ç†å‚è€ƒå›¾ç‰‡

5. å¤šç”¨æˆ·ç‰¹æ€§ï¼š
   - æ¯ä¸ªç”¨æˆ·æ‹¥æœ‰ç‹¬ç«‹çš„æ•°æ®ç©ºé—´
   - ç”Ÿæˆçš„å›¾ç‰‡ä¿å­˜åœ¨å„è‡ªçš„ç›®å½•ä¸­ï¼ˆ`output/ç”¨æˆ·ID/`ï¼‰
   - ä¸Šä¼ çš„ç¤ºä¾‹å›¾ä¿å­˜åœ¨ï¼ˆ`uploads/ç”¨æˆ·ID/`ï¼‰
   - OSSç¤ºä¾‹å›¾æŒ‰ç”¨æˆ·éš”ç¦»ï¼ˆ`sample/user_ç”¨æˆ·ID/`ï¼‰
   - ç”¨æˆ·ä¹‹é—´æ•°æ®å®Œå…¨éš”ç¦»ï¼Œäº’ä¸å¹²æ‰°
   - æ³¨å†ŒåŠŸèƒ½å·²ç¦ç”¨ï¼Œéœ€ç”±ç®¡ç†å‘˜æ‰‹åŠ¨åˆ›å»ºè´¦å·

## é¡¹ç›®ç»“æ„

```
jimeng4_image_generator/
â”œâ”€â”€ app.py              # Flask WebæœåŠ¡
â”œâ”€â”€ main.py             # æ ¸å¿ƒåŠŸèƒ½å®ç°
â”œâ”€â”€ requirements.txt    # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ .env.example        # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ example_prompts.txt # ç¤ºä¾‹æç¤ºè¯
â”œâ”€â”€ templates/          # ç½‘é¡µæ¨¡æ¿
â”‚   â””â”€â”€ index.html      # ä¸»é¡µé¢
â””â”€â”€ static/             # é™æ€èµ„æº
    â”œâ”€â”€ style.css       # æ ·å¼æ–‡ä»¶
    â””â”€â”€ script.js       # JavaScriptäº¤äº’
```

## æ³¨æ„äº‹é¡¹

1. APIå¯†é’¥å®‰å…¨ï¼šè¯·å¦¥å–„ä¿ç®¡æ‚¨çš„Access Keyå’ŒSecret Keyï¼Œä¸è¦æ³„éœ²ç»™ä»–äºº
2. ç”Ÿæˆé™åˆ¶ï¼šå…è´¹é¢åº¦å¯èƒ½æœ‰é™ï¼Œè¯·åˆç†ä½¿ç”¨
3. æç¤ºè¯æŠ€å·§ï¼š
   - å°½é‡è¯¦ç»†æè¿°æ‚¨æƒ³è¦çš„å›¾åƒ
   - å¯ä»¥æŒ‡å®šè‰ºæœ¯é£æ ¼ã€è‰²å½©ã€æ„å›¾ç­‰
   - ä¸­è‹±æ–‡å‡å¯ï¼Œå»ºè®®ä¸è¶…è¿‡300ä¸ªæ±‰å­—

## è®¸å¯è¯

MIT License